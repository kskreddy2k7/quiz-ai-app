#:import dp kivy.metrics.dp
#:import ButtonBehavior kivy.uix.behaviors.ButtonBehavior

<PrimaryButton@Button>:
    background_normal: ""
    background_color: 0, 0, 0, 0
    color: 1, 1, 1, 1
    font_size: "16sp"
    size_hint_y: None
    height: dp(52)
    padding: dp(16), dp(12)
    canvas.before:
        Color:
            rgba: (0.25, 0.42, 0.85, 1) if self.state == "down" else (0.3, 0.48, 0.9, 1)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [18, 18, 18, 18]

<SecondaryButton@Button>:
    background_normal: ""
    background_color: 0, 0, 0, 0
    color: 0.2, 0.25, 0.4, 1
    font_size: "15sp"
    size_hint_y: None
    height: dp(48)
    padding: dp(14), dp(10)
    canvas.before:
        Color:
            rgba: (0.86, 0.9, 1, 1) if self.state == "down" else (0.9, 0.93, 1, 1)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [16, 16, 16, 16]

<HomeCard@ButtonBehavior+BoxLayout>:
    orientation: "vertical"
    padding: dp(16)
    spacing: dp(8)
    size_hint_y: None
    height: dp(120)
    canvas.before:
        Color:
            rgba: (0.92, 0.95, 1, 1) if self.state == "down" else (1, 1, 1, 1)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [20, 20, 20, 20]
        Color:
            rgba: 0.85, 0.88, 0.96, 1
        Line:
            rounded_rectangle: (self.x, self.y, self.width, self.height, 20)

<Card@BoxLayout>:
    orientation: "vertical"
    padding: dp(16)
    spacing: dp(12)
    size_hint_y: None
    height: self.minimum_height
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [18, 18, 18, 18]

ScreenManager:
    SplashScreen:
        name: "splash"
    HomeScreen:
        name: "home"
    QuizScreen:
        name: "quiz"
    ResultsScreen:
        name: "results"
    MaterialsScreen:
        name: "materials"

<SplashScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(28)
        spacing: dp(18)
        canvas.before:
            Color:
                rgba: 0.94, 0.96, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
            Color:
                rgba: 0.85, 0.9, 1, 0.7
            Rectangle:
                pos: self.x, self.y + self.height * 0.4
                size: self.width, self.height * 0.6
        Widget:
        BoxLayout:
            orientation: "vertical"
            size_hint_y: None
            height: self.minimum_height
            spacing: dp(16)
            Label:
                text: "Quiz AI"
                font_size: "36sp"
                bold: True
                color: 0.15, 0.22, 0.45, 1
            Label:
                text: "Believe in yourself. Small steps every day lead to big success."
                font_size: "17sp"
                color: 0.25, 0.3, 0.45, 1
                text_size: self.width, None
                halign: "center"
                valign: "middle"
            Label:
                text: "Created with motivation by\\nKata Sai Kranthu Reddy"
                font_size: "16sp"
                color: 0.3, 0.35, 0.5, 1
                text_size: self.width, None
                halign: "center"
                valign: "middle"
        Widget:

<HomeScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(16)
        canvas.before:
            Color:
                rgba: 0.96, 0.97, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
        BoxLayout:
            orientation: "vertical"
            size_hint_y: None
            height: self.minimum_height
            spacing: dp(6)
            Label:
                text: "Welcome, Learner!"
                font_size: "26sp"
                bold: True
                color: 0.15, 0.2, 0.4, 1
            Label:
                text: root.daily_quote
                font_size: "15sp"
                color: 0.25, 0.3, 0.45, 1
                text_size: self.width, None
                halign: "center"
        HomeCard:
            on_release: app.start_quiz()
            BoxLayout:
                orientation: "horizontal"
                spacing: dp(12)
                Label:
                    text: "▶"
                    font_size: "26sp"
                    color: 0.3, 0.45, 0.9, 1
                    size_hint_x: None
                    width: dp(32)
                BoxLayout:
                    orientation: "vertical"
                    spacing: dp(4)
                    Label:
                        text: "Start Quiz"
                        font_size: "18sp"
                        bold: True
                        color: 0.15, 0.2, 0.4, 1
                        halign: "left"
                        text_size: self.width, None
                    Label:
                        text: "Test your knowledge with smart questions."
                        font_size: "13sp"
                        color: 0.35, 0.4, 0.55, 1
                        halign: "left"
                        text_size: self.width, None
        HomeCard:
            BoxLayout:
                orientation: "horizontal"
                spacing: dp(12)
                Label:
                    text: "✦"
                    font_size: "26sp"
                    color: 0.55, 0.45, 0.9, 1
                    size_hint_x: None
                    width: dp(32)
                BoxLayout:
                    orientation: "vertical"
                    spacing: dp(4)
                    Label:
                        text: "AI Tutor"
                        font_size: "18sp"
                        bold: True
                        color: 0.15, 0.2, 0.4, 1
                        halign: "left"
                        text_size: self.width, None
                    Label:
                        text: "Personalized help for every concept."
                        font_size: "13sp"
                        color: 0.35, 0.4, 0.55, 1
                        halign: "left"
                        text_size: self.width, None
        HomeCard:
            BoxLayout:
                orientation: "horizontal"
                spacing: dp(12)
                Label:
                    text: "❖"
                    font_size: "26sp"
                    color: 0.3, 0.6, 0.7, 1
                    size_hint_x: None
                    width: dp(32)
                BoxLayout:
                    orientation: "vertical"
                    spacing: dp(4)
                    Label:
                        text: "Daily Motivation"
                        font_size: "18sp"
                        bold: True
                        color: 0.15, 0.2, 0.4, 1
                        halign: "left"
                        text_size: self.width, None
                    Label:
                        text: "Stay inspired with daily goals."
                        font_size: "13sp"
                        color: 0.35, 0.4, 0.55, 1
                        halign: "left"
                        text_size: self.width, None
        HomeCard:
            BoxLayout:
                orientation: "horizontal"
                spacing: dp(12)
                Label:
                    text: "✓"
                    font_size: "26sp"
                    color: 0.2, 0.55, 0.45, 1
                    size_hint_x: None
                    width: dp(32)
                BoxLayout:
                    orientation: "vertical"
                    spacing: dp(4)
                    Label:
                        text: "Progress"
                        font_size: "18sp"
                        bold: True
                        color: 0.15, 0.2, 0.4, 1
                        halign: "left"
                        text_size: self.width, None
                    Label:
                        text: "Track quizzes, streaks, and growth."
                        font_size: "13sp"
                        color: 0.35, 0.4, 0.55, 1
                        halign: "left"
                        text_size: self.width, None
        Card:
            Label:
                text: "Permission note"
                font_size: "15sp"
                bold: True
                color: 0.2, 0.25, 0.4, 1
            Label:
                text: "We use storage permission to keep study materials offline. Camera and microphone are optional for future learning features."
                font_size: "13sp"
                color: 0.3, 0.35, 0.5, 1
                text_size: self.width, None
                halign: "center"
            Label:
                text: root.permission_status
                font_size: "13sp"
                color: 0.3, 0.35, 0.5, 1
                text_size: self.width, None
                halign: "center"
        BoxLayout:
            orientation: "horizontal"
            spacing: dp(12)
            size_hint_y: None
            height: dp(52)
            PrimaryButton:
                text: "Start Quiz"
                on_release: app.start_quiz()
            SecondaryButton:
                text: "Study Materials"
                on_release: app.root.current = "materials"
        Widget:

<QuizScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(12)
        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
        Label:
            text: root.progress_text
            font_size: "14sp"
            color: 0.3, 0.35, 0.45, 1
        Label:
            text: root.question_text
            font_size: "20sp"
            bold: True
            color: 0.2, 0.25, 0.4, 1
            text_size: self.width, None
            halign: "center"
        PrimaryButton:
            text: root.option_texts[0] if len(root.option_texts) > 0 else ""
            on_release: app.submit_answer(self.text)
        PrimaryButton:
            text: root.option_texts[1] if len(root.option_texts) > 1 else ""
            on_release: app.submit_answer(self.text)
        PrimaryButton:
            text: root.option_texts[2] if len(root.option_texts) > 2 else ""
            on_release: app.submit_answer(self.text)
        PrimaryButton:
            text: root.option_texts[3] if len(root.option_texts) > 3 else ""
            on_release: app.submit_answer(self.text)
        SecondaryButton:
            text: "Back to Home"
            on_release: app.go_home()

<ResultsScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(16)
        canvas.before:
            Color:
                rgba: 0.95, 0.98, 0.97, 1
            Rectangle:
                pos: self.pos
                size: self.size
        Label:
            text: "Quiz Complete!"
            font_size: "22sp"
            bold: True
            color: 0.15, 0.45, 0.35, 1
        Label:
            text: root.score_text
            font_size: "18sp"
            color: 0.2, 0.3, 0.4, 1
        Label:
            text: root.encouragement_text
            font_size: "16sp"
            color: 0.2, 0.3, 0.4, 1
            text_size: self.width, None
            halign: "center"
        PrimaryButton:
            text: "Try Another Quiz"
            on_release: app.start_quiz()
        PrimaryButton:
            text: "Back to Home"
            on_release: app.go_home()

<MaterialsScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(12)
        canvas.before:
            Color:
                rgba: 0.96, 0.97, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
        Label:
            text: "Study Materials"
            font_size: "22sp"
            bold: True
            color: 0.2, 0.25, 0.45, 1
        Label:
            text: "Keep your notes and files handy for quick review."
            font_size: "16sp"
            color: 0.3, 0.35, 0.5, 1
            text_size: self.width, None
            halign: "center"
        Label:
            text: "Store PDFs, PPTs, or DOCs on your device and open them anytime."
            font_size: "14sp"
            color: 0.35, 0.4, 0.55, 1
            text_size: self.width, None
            halign: "center"
        SecondaryButton:
            text: "Back to Home"
            on_release: app.go_home()
