<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizAI Learning Platform</title>
    <!-- Sci-Fi Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>

    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="brand">
            <span>ğŸ“ QuizAI</span>
        </div>

        <div class="nav-item active" onclick="app.showSetup()">
            <span>ğŸ  Home</span>
        </div>
        <div class="nav-item" onclick="app.showLibrary()">
            <span>ğŸ“š</span> My Library
        </div>
        <div class="nav-item" onclick="app.showTutor()">
            <span>ğŸ¤–</span> AI Tutor
        </div>

        <div style="flex:1"></div>
        <div class="text-muted" style="font-size: 0.8rem">
            Logged in as <span id="user-display">Student</span>
            <div class="nav-item" onclick="app.logout()"
                style="justify-content: flex-start; padding: 5px 0; color: var(--error)">
                <span>ğŸšª Logout</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">

        <!-- Auth View -->
        <div id="auth-view" class="screen" style="display: none; max-width: 400px; margin: 50px auto;">
            <div class="card"
                style="text-align: center; border: 1px solid var(--glass-border); background: rgba(30, 41, 59, 0.6);">
                <h1 class="header-md" style="margin-bottom: 20px; font-size: 2rem;">Welcome Back! ğŸ‘‹</h1>
                <p class="text-muted" style="margin-bottom: 30px;">Login to access your AI Tutor & Library.</p>

                <input type="text" id="username-input" class="input-field" placeholder="Username or Email">
                <input type="password" id="password-input" class="input-field" placeholder="Password">

                <button class="btn" onclick="app.login()">
                    <span>ğŸš€</span> Login / Register
                </button>
                <p class="text-muted" style="margin-top: 15px; font-size: 0.85rem;">
                    *New users are automatically registered.
                </p>
            </div>
        </div>

        <div id="app-container" style="display: none;">
            <!-- Setup View -->
            <div id="setup-view" class="screen">
                <h1 class="header-lg">What do you want to learn today?</h1>
                <p class="text-muted" style="margin-bottom: 30px">Generate a custom quiz from a topic or upload your
                    study material.</p>

                <div class="card">
                    <h2 class="header-md">âœ¨ Magic Generator</h2>

                    <div class="upload-area" id="drop-zone" onclick="document.getElementById('file-upload').click()">
                        <p id="file-label">ğŸ“„ Drag & drop a PDF/DOCX here or click to upload</p>
                        <input type="file" id="file-upload" hidden accept=".pdf,.docx,.txt"
                            onchange="app.handleFileSelect(this)">
                    </div>

                    <div style="text-align: center; margin: 20px 0; color: var(--text-muted)">OR</div>

                    <input type="text" id="topic-input" class="input-field"
                        placeholder="Enter a topic (e.g., Quantum Physics, French Revolution)...">

                    <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                        <select id="difficulty-select" class="input-field" style="width: auto; flex: 1">
                            <option value="easy">Easy (Basics)</option>
                            <option value="medium" selected>Medium (Application)</option>
                            <option value="hard">Hard (Complex)</option>
                        </select>
                        <select id="mastery-select" class="input-field" style="width: auto; flex: 1">
                            <option value="Beginner">Beginner (Zero Level)</option>
                            <option value="Intermediate" selected>Intermediate (Standard)</option>
                            <option value="Advanced">Advanced (Deep Dive)</option>
                            <option value="Exam">Exam (IIT/JEE/Competitive)</option>
                        </select>
                        <input type="number" id="q-count" class="input-field" value="5" min="1" max="20"
                            style="width: 80px">
                    </div>

                    <button class="btn" onclick="app.generateQuiz()">
                        ğŸš€ Start Learning
                    </button>
                    <div id="loading" style="display:none; text-align: center; margin-top: 15px; color: var(--primary)">
                        <div class="spinner"
                            style="border-color: var(--primary); border-top-color: transparent; margin: 0 auto 10px;">
                        </div>
                        Preparing your lesson...
                    </div>
                </div>
            </div>

            <!-- Library View -->
            <div id="library-view" class="screen" style="display: none;">
                <h1 class="header-md">ğŸ“š My Library</h1>
                <p class="text-muted">Your uploaded files and summaries.</p>
                <div id="library-list">
                    <!-- Items go here -->
                </div>
            </div>

            <!-- AI TUTOR VIEW -->
            <div id="tutor-view" class="screen" style="display: none;">
                <div class="header-lg">ğŸ¤– AI Personal Tutor</div>
                <p class="text-muted" style="margin-bottom: 20px;">Ask me anything! I can explain concepts, solve
                    problems, or guide your learning.</p>

                <div class="chat-container" style="height: 65vh;">
                    <div id="tutor-history" class="chat-messages">
                        <div class="msg msg-bot">Hello! I'm your AI Tutor. What subject are we conquering today? ğŸš€
                        </div>
                    </div>
                    <div class="chat-input-area">
                        <input type="text" id="tutor-input" class="input-field" style="margin-bottom: 0;"
                            placeholder="Ask a question..." onkeypress="if(event.key==='Enter') app.sendTutorMessage()">
                        <button class="btn" style="width: auto;" onclick="app.sendTutorMessage()">Send</button>
                    </div>
                </div>
            </div>

            <!-- Quiz View -->
            <div id="quiz-view" class="screen" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="header-md" id="quiz-topic-display">Topic</h2>
                    <span class="text-muted">Question <span id="current-q">1</span>/<span id="total-q">5</span></span>
                </div>

                <div class="card">
                    <p class="question-text" id="question-text">...</p>
                    <div id="options-container"></div>

                    <!-- Explanation Box -->
                    <div id="explanation-box" class="explanation-box">
                        <strong>ğŸ’¡ Explanation:</strong>
                        <p id="explanation-text" style="margin-top: 5px; white-space: pre-wrap;"></p>

                        <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-outline" style="font-size: 0.9rem; padding: 8px 16px; width: auto"
                                onclick="app.askTeacher()">
                                ğŸ™‹â€â™‚ï¸ Ask Teacher
                            </button>
                            <button class="btn" style="width: auto; margin-left: auto;" id="next-btn"
                                onclick="app.nextQuestion()">
                                Next Question ğŸ‘‰
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Result View -->
            <div id="result-view" class="screen" style="display: none; text-align: center; padding-top: 40px;">
                <h1 class="header-lg">Lesson Complete! ğŸ‰</h1>
                <div class="card" style="max-width: 400px; margin: 30px auto;">
                    <h2 class="header-lg" style="color: var(--primary)" id="final-score">80%</h2>
                    <p class="text-muted">Great effort! Review your weak areas.</p>
                    <button class="btn" style="margin-top: 20px;" onclick="app.showSetup()">Start New Lesson</button>
                    <button class="btn btn-secondary" style="margin-top: 10px;" onclick="app.shareQuiz()"
                        id="share-btn">ğŸ”— Share Result</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Chat Modal (Simple overlay for now) -->
    <div id="chat-modal"
        style="display:none; position: fixed; bottom: 20px; right: 20px; width: 350px; z-index: 1000; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">
        <div class="chat-container">
            <div
                style="padding: 15px; background: var(--primary); color: white; border-top-left-radius: 12px; border-top-right-radius: 12px; display: flex; justify-content: space-between;">
                <span>ğŸ‘©â€ğŸ« Friendly Teacher</span>
                <span style="cursor: pointer"
                    onclick="document.getElementById('chat-modal').style.display='none'">âœ–</span>
            </div>
            <div class="chat-messages" id="chat-history">
                <div class="msg msg-bot">Hello! I'm here to help you understand better. Ask me anything about this
                    question!</div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" class="input-field" style="margin-bottom: 0"
                    placeholder="Type your doubt..." onkeypress="if(event.key === 'Enter') app.sendChatMessage()">
                <button class="btn" style="width: auto; padding: 0 15px;" onclick="app.sendChatMessage()">â¤</button>
            </div>
        </div>
    </div>

    <!-- App Promo -->
    <div id="app-promo" class="card"
        style="position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; display: none; z-index: 2000; padding: 15px; border-color: var(--primary);">
        <div style="display: flex; justify-content: space-between; align-items: center">
            <div>
                <h3 class="header-md" style="font-size: 1rem; margin-bottom: 2px">ğŸ“± Learn on the Go!</h3>
                <p class="text-muted" style="font-size: 0.8rem; margin-bottom: 0;">Download the Android App.</p>
            </div>
            <button class="btn" style="width: auto; padding: 6px 12px; font-size: 0.85rem"
                onclick="alert('Download link coming soon!')">Download</button>
            <div style="position: absolute; top: 5px; right: 8px; cursor: pointer; color: #999; line-height: 1;"
                onclick="document.getElementById('app-promo').style.display='none'; localStorage.setItem('promoDismissed', 'true');">
                Ã—</div>
        </div>
    </div>

    <script src="/static/translations.js"></script>
    <script src="/static/script.js"></script>
</body>

</html>