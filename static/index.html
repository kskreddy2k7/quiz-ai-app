<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S Quiz - AI Learning Platform</title>
    <!-- Poppins Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <!-- Google Sign-In -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <!-- CSS -->
    <link rel="stylesheet" href="/static/style.css?v=6">
</head>

<body>

    <!-- Auth View -->
    <div id="auth-view" class="glass-card screen auth-screen"
        style="display: none; max-width: 450px; margin: 5vh auto; padding: 60px 40px; animation: scaleIn 0.5s ease-out;">
        <div style="text-align: center; margin-bottom: 40px;">
            <div class="app-icon" style="margin: 0 auto 20px; width: 80px; height: 80px; font-size: 3rem;">
                <i class="bi bi-stars"></i>
            </div>
            <h1 class="app-title" style="font-size: 2.5rem; margin-bottom: 10px;">Welcome Back</h1>
            <p class="text-muted">Your personal AI study companion.</p>
        </div>

        <!-- Motivational Quote on Login Screen -->
        <div class="auth-quote-card" style="background: rgba(139, 92, 246, 0.1); border-left: 3px solid var(--accent); padding: 15px; margin-bottom: 30px; border-radius: 8px;">
            <i class="bi bi-quote" style="color: var(--accent); font-size: 1.2rem; margin-bottom: 5px; display: block;"></i>
            <p id="auth-quote-text" style="font-style: italic; color: var(--text-body); margin: 0; font-size: 0.95rem;">"The beautiful thing about learning is that no one can take it away from you."</p>
            <span id="auth-quote-author" class="quote-author" style="display: block; margin-top: 8px; font-size: 0.85rem;">‚Äî B.B. King</span>
        </div>

        <!-- Google Sign-In Button -->
        <button id="google-signin-btn" class="btn-google" onclick="app.googleSignIn()">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19.6 10.227c0-.709-.064-1.39-.182-2.045H10v3.868h5.382a4.6 4.6 0 01-1.996 3.018v2.51h3.232c1.891-1.742 2.982-4.305 2.982-7.35z" fill="#4285F4"/>
                <path d="M10 20c2.7 0 4.964-.895 6.618-2.423l-3.232-2.509c-.895.6-2.04.955-3.386.955-2.605 0-4.81-1.76-5.595-4.123H1.064v2.59A9.996 9.996 0 0010 20z" fill="#34A853"/>
                <path d="M4.405 11.9c-.2-.6-.314-1.24-.314-1.9 0-.66.114-1.3.314-1.9V5.51H1.064A9.996 9.996 0 000 10c0 1.614.386 3.14 1.064 4.49L4.405 11.9z" fill="#FBBC05"/>
                <path d="M10 3.977c1.468 0 2.786.505 3.823 1.496l2.868-2.868C14.959.99 12.695 0 10 0 6.09 0 2.71 2.24 1.064 5.51l3.34 2.59C5.19 5.736 7.395 3.977 10 3.977z" fill="#EA4335"/>
            </svg>
            <span>Continue with Google</span>
        </button>

        <div style="display: flex; align-items: center; margin: 30px 0;">
            <hr style="flex:1; border:0; border-top:1px solid rgba(255,255,255,0.2);">
            <span style="padding: 0 10px; color: var(--text-muted); font-size: 0.9rem;">OR</span>
            <hr style="flex:1; border:0; border-top:1px solid rgba(255,255,255,0.2);">
        </div>

        <input type="text" id="username-input" class="input-field" placeholder="Username or Email">
        <input type="password" id="password-input" class="input-field" placeholder="Password">

        <button class="btn" onclick="app.login()">Start Learning üöÄ</button>

        <div style="display: flex; align-items: center; margin: 30px 0 20px;">
            <hr style="flex:1; border:0; border-top:1px solid rgba(255,255,255,0.2);">
            <span style="padding: 0 10px; color: var(--text-muted); font-size: 0.9rem;">OR</span>
            <hr style="flex:1; border:0; border-top:1px solid rgba(255,255,255,0.2);">
        </div>

        <button class="btn btn-secondary" onclick="app.guestLogin()">Continue as Guest üë§</button>
    </div>

    <!-- Main App Container -->
    <div id="app-container" style="display: none; width: 100%;">

        <!-- User Controls (Fixed Top Right) -->
        <div style="position: fixed; top: 25px; right: 30px; z-index: 1000;" class="user-controls">
            <div class="glass-panel user-profile-dropdown"
                style="padding: 10px 20px; display: flex; align-items: center; gap: 12px; border-radius: 50px; cursor: pointer;"
                onclick="app.toggleProfileMenu()">
                <div id="user-avatar"
                    style="width: 32px; height: 32px; background: var(--primary-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; overflow: hidden;">
                    <i class="bi bi-person-fill"></i>
                </div>
                <span id="user-display" style="font-weight: 600; font-size: 0.95rem; color: white;">Student</span>
                <i class="bi bi-chevron-down" 
                    style="color: var(--text-muted); font-size: 0.8rem; transition: transform 0.3s;"></i>
            </div>
            
            <!-- Profile Dropdown Menu -->
            <div id="profile-menu" class="profile-menu glass-panel" style="display: none;">
                <div class="profile-menu-item" onclick="app.viewProfile()">
                    <i class="bi bi-person-circle"></i>
                    <span>Profile</span>
                </div>
                <div class="profile-menu-item" onclick="app.logout()">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>Logout</span>
                </div>
            </div>
        </div>

        <!-- App Header (Logo Only - Clean) -->
        <div class="app-header-section">
            <div class="app-logo-main">
                <div class="app-icon-large"><i class="bi bi-lightning-charge-fill"></i></div>
                <h1 class="app-title-large">S Quiz</h1>
                <p class="app-tagline">AI Learning Platform</p>
            </div>
        </div>

        <!-- Daily Motivation Card (Dismissible) -->
        <div id="daily-motivation-card" class="daily-motivation-card" style="display: none;">
            <button class="close-motivation" onclick="app.dismissMotivation()">√ó</button>
            <i class="bi bi-lightbulb-fill" style="color: #fbbf24; font-size: 1.5rem; margin-bottom: 8px;"></i>
            <p id="motivation-text" class="motivation-text"></p>
            <span id="motivation-author" class="quote-author"></span>
        </div>

        <!-- Navigation Sidebar (Collapsible) -->
        <nav class="floating-nav collapsed" id="sidebar-nav">
            <div class="nav-pill active" title="Home"
                onclick="app.showTopic(); document.getElementById('topic-input').focus(); setActiveNav(this)">
                <i class="bi bi-house-fill"></i> <span class="nav-label">Home</span>
            </div>
            <div class="nav-pill" title="Upload" onclick="app.showUpload(); setActiveNav(this)">
                <i class="bi bi-cloud-arrow-up-fill"></i> <span class="nav-label">Upload</span>
            </div>
            <div class="nav-pill" title="Notes" onclick="app.showNotes(); setActiveNav(this)">
                <i class="bi bi-journal-text"></i> <span class="nav-label">Notes</span>
            </div>
            <div class="nav-pill" title="Tutor" onclick="app.showTutor(); setActiveNav(this)">
                <i class="bi bi-chat-dots-fill"></i> <span class="nav-label">Tutor</span>
            </div>
        </nav>

        <div class="container">
            <!-- OLD Header removed from here -->
            <!-- Content starts directly -->

            <!-- 1. Topic Quiz View -->
            <div id="topic-view" class="screen">
                <div class="glass-card" style="text-align: center;">
                    <h2 style="margin-bottom: 30px; font-weight: 700; font-size: 1.8rem;">What do you want to learn today?</h2>
                    <input type="text" id="topic-input" class="input-field"
                        placeholder="Enter a topic (e.g. 'Photosynthesis', 'Civil War')">

                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 30px;">
                        <input type="number" id="q-count" class="input-field" value="5" min="3" max="20"
                            placeholder="Questions">
                        <select id="difficulty-select" class="input-field">
                            <option value="Easy">Easy</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="Hard">Hard</option>
                        </select>
                        <select id="language-select" class="input-field">
                            <option value="English">English</option>
                            <option value="Hindi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
                            <option value="Telugu">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)</option>
                            <option value="Tamil">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)</option>
                            <option value="Kannada">‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)</option>
                            <option value="Malayalam">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç (Malayalam)</option>
                            <option value="Marathi">‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)</option>
                            <option value="Gujarati">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)</option>
                            <option value="Punjabi">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä (Punjabi)</option>
                            <option value="Bengali">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)</option>
                            <option value="Odia">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü (Odia)</option>
                            <option value="Urdu">ÿßÿ±ÿØŸà (Urdu)</option>
                        </select>
                    </div>

                    <button class="btn" onclick="app.generateTopicQuiz()">
                        Generate Quiz üöÄ
                    </button>

                    <div id="loading-topic" style="display:none; margin-top: 30px;">
                        <!-- AI loading steps will be injected here -->
                    </div>
                </div>
            </div>

            <!-- 2. Upload View -->
            <div id="upload-view" class="screen" style="display: none;">
                <div class="glass-card">
                    <h2 style="text-align: center; margin-bottom: 30px;">Upload Study Material</h2>
                    <div class="upload-area" onclick="document.getElementById('file-upload').click()">
                        <i class="bi bi-file-earmark-text"
                            style="font-size: 3rem; color: var(--accent); margin-bottom: 15px; display: block;"></i>
                        <h3 style="font-size: 1.2rem; margin-bottom: 10px;">Drop your PDF or Text file here</h3>
                        <p id="file-label-text" style="color: var(--text-muted); font-size: 0.9rem;">Tap to browse files
                        </p>
                        <input type="file" id="file-upload" hidden onchange="app.handleFileSelect(this)">
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
                        <input type="number" id="file-q-count" class="input-field" value="10" placeholder="Questions">
                        <select id="file-difficulty-select" class="input-field">
                            <option value="Easy">Easy</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="Hard">Hard</option>
                        </select>
                    </div>
                    <select id="file-language-select" class="input-field">
                        <option value="English">English</option>
                        <option value="Hindi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
                        <option value="Telugu">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å (Telugu)</option>
                        <option value="Tamil">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)</option>
                        <option value="Kannada">‡≤ï‡≤®‡≥ç‡≤®‡≤° (Kannada)</option>
                        <option value="Malayalam">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç (Malayalam)</option>
                        <option value="Marathi">‡§Æ‡§∞‡§æ‡§†‡•Ä (Marathi)</option>
                        <option value="Gujarati">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)</option>
                        <option value="Punjabi">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä (Punjabi)</option>
                        <option value="Bengali">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ (Bengali)</option>
                        <option value="Odia">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü (Odia)</option>
                        <option value="Urdu">ÿßÿ±ÿØŸà (Urdu)</option>
                    </select>

                    <button class="btn" onclick="app.generateFileQuiz()">Generate from File üìÇ</button>

                    <div id="loading-file" style="display:none; margin-top: 20px; text-align: center;">
                        <div class="spinner"
                            style="border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--accent); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto;">
                        </div>
                        <p style="margin-top: 10px;">Analyzing document...</p>
                    </div>
                </div>
            </div>

            <!-- 3. Smart Notes View -->
            <div id="presentation-view" class="screen" style="display: none;">
                <div class="glass-card">
                    <h2 style="text-align: center; margin-bottom: 10px;">Smart Notes Creator</h2>
                    <p style="text-align: center; color: var(--text-muted); margin-bottom: 30px;">Turn any topic into a
                        professional study guide.</p>

                    <input type="text" id="ppt-topic" class="input-field"
                        placeholder="Enter topic (e.g. 'Photosynthesis')">

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <select id="ppt-format" class="input-field" style="margin-bottom: 0;">
                            <option value="pdf" selected>üìÑ PDF Guide</option>
                            <option value="docx">üìù Word Doc</option>
                            <option value="pptx">üìä Slides (PPTX)</option>
                        </select>
                        <select id="ppt-font" class="input-field" style="margin-bottom: 0;">
                            <option value="Modern">Modern Sans</option>
                            <option value="Classic">Classic Serif</option>
                        </select>
                    </div>
                    <input type="hidden" id="ppt-slides" value="10">

                    <button class="btn" onclick="app.generateNotes()">Create Notes ‚ú®</button>

                    <div id="ppt-loading" style="display:none; text-align: center; margin-top: 30px;">
                        <div class="spinner"
                            style="border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--accent); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto;">
                        </div>
                        <p style="margin-top: 15px; font-weight: 500;">Researching & Writing...<br><span
                                style="font-size: 0.85rem; opacity: 0.7;">This may take a moment.</span></p>
                    </div>
                </div>
            </div>

            <!-- 4. Tutor View -->
            <div id="tutor-view" class="screen" style="display: none;">
                <div class="glass-card"
                    style="padding: 0; overflow: hidden; height: 75vh; display: flex; flex-direction: column;">
                    <div
                        style="padding: 20px; border-bottom: 1px solid var(--glass-border); background: rgba(0,0,0,0.1);">
                        <h3 style="margin: 0; font-size: 1.2rem;"><i class="bi bi-robot"></i> AI Tutor</h3>
                    </div>

                    <div id="tutor-history"
                        style="flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px;">
                        <div class="msg msg-bot">Hello! I'm your AI tutor. Ask me anything about your studies! üëã</div>
                    </div>

                    <div style="padding: 20px; border-top: 1px solid var(--glass-border); display: flex; gap: 10px;">
                        <input type="text" id="tutor-input" class="input-field" style="margin-bottom: 0;"
                            placeholder="Ask a question..." onkeypress="if(event.key==='Enter') app.sendTutorMessage()">
                        <button class="btn" style="width: auto; padding: 0 25px;" onclick="app.sendTutorMessage()">
                            <i class="bi bi-send-fill"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 5. Quiz Taking View -->
            <div id="quiz-view" class="screen" style="display: none;">
                <div class="glass-card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <span style="font-weight: 600; color: var(--accent);" id="quiz-topic-display">Topic</span>
                        <div class="header-badge" style="margin: 0;">Q <span id="current-q">1</span> / <span
                                id="total-q">5</span></div>
                    </div>

                    <h3 id="question-text" style="font-size: 1.3rem; margin-bottom: 30px; line-height: 1.6;">Question
                        goes here?</h3>

                    <div id="options-container" style="display: grid; gap: 15px; margin-bottom: 30px;">
                        <!-- Options injected by JS -->
                    </div>

                    <!-- Explanation -->
                    <div id="explanation-box" class="explanation-box"
                        style="display:none; padding: 20px; margin-top: 20px;">
                        <h4 style="margin-bottom: 10px; color: #065f46;"><i class="bi bi-lightbulb-fill"></i>
                            Explanation</h4>
                        <p id="explanation-text" style="font-size: 0.95rem; color: #064e3b;"></p>
                    </div>

                    <button class="btn" onclick="app.nextQuestion()" style="margin-top: 20px;">Next Question <i
                            class="bi bi-arrow-right"></i></button>
                </div>
            </div>

            <!-- 6. Result View -->
            <div id="result-view" class="screen" style="display: none;">
                <div class="glass-card" style="text-align: center;">
                    <i class="bi bi-trophy-fill"
                        style="font-size: 4rem; color: #fbbf24; margin-bottom: 20px; display: block; filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5));"></i>
                    <h2 style="font-size: 2.5rem; margin-bottom: 10px;">Quiz Complete!</h2>
                    <p class="text-muted">You scored</p>
                    <div id="final-score"
                        style="font-size: 4rem; font-weight: 800; background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 10px 0;">
                        90%</div>

                    <!-- Motivational Quote on Result Screen -->
                    <div class="result-quote-card" style="background: rgba(139, 92, 246, 0.1); border-left: 3px solid var(--accent); padding: 20px; margin: 30px 0; border-radius: 12px;">
                        <i class="bi bi-stars" style="color: var(--accent); font-size: 1.5rem; margin-bottom: 8px; display: block;"></i>
                        <p id="result-quote-text" style="font-style: italic; color: var(--text-body); margin: 0; font-size: 1rem;"></p>
                        <span id="result-quote-author" class="quote-author" style="display: block; margin-top: 10px; font-size: 0.9rem;"></span>
                    </div>

                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 40px;">
                        <button class="btn" onclick="app.showTopic()">New Quiz ‚Ü∫</button>
                        <button class="btn btn-secondary" onclick="app.shareQuiz()" style="width: auto;"><i
                                class="bi bi-share-fill"></i></button>
                    </div>
                </div>
            </div>

            <!-- 7. Library List View -->
            <div id="library-view" class="screen" style="display: none;">
                <!-- Content injected by JS -->
                <div id="library-list"></div>
            </div>

        </div> <!-- End Container -->
    </div> <!-- End App Container -->

    <style>
        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }
    </style>

    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ú® Welcome to S Quiz!</h2>
                <p>Your AI Learning Companion</p>
            </div>
            <div class="modal-body">
                <h3 style="margin-bottom: 20px; font-size: 1.2rem;"><i class="bi bi-lightbulb-fill"></i> What S Quiz Does:</h3>
                <ul style="list-style: none; padding: 0; font-size: 1rem;">
                    <li style="padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <i class="bi bi-lightning-charge-fill" style="color: var(--accent); margin-right: 10px;"></i>
                        <strong>AI-Generated Quizzes:</strong> Create personalized quizzes on any topic in seconds
                    </li>
                    <li style="padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <i class="bi bi-translate" style="color: var(--accent); margin-right: 10px;"></i>
                        <strong>Multi-Language Support:</strong> Learn in your preferred language (12+ languages)
                    </li>
                    <li style="padding: 12px 0;">
                        <i class="bi bi-chat-dots-fill" style="color: var(--accent); margin-right: 10px;"></i>
                        <strong>AI Tutor:</strong> Get instant help and explanations anytime you need
                    </li>
                </ul>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="app.startLearning()">
                    Start Learning üöÄ
                </button>
            </div>
        </div>
    </div>

    <!-- PWA Install Banner (Hidden by default, shown when applicable) -->
    <div id="pwa-banner" class="pwa-banner" style="display: none;">
        <div class="pwa-banner-icon">üì±</div>
        <div class="pwa-banner-content">
            <h3>Install S Quiz</h3>
            <p>Add to your home screen for a better experience!</p>
        </div>
        <div class="pwa-banner-actions">
            <button class="pwa-btn pwa-btn-install" onclick="app.installPWA()">Install</button>
            <button class="pwa-btn pwa-btn-dismiss" onclick="app.dismissPWA()">Not Now</button>
        </div>
    </div>

    <!-- APK Download Modal for Android -->
    <div id="apk-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <button class="modal-close" onclick="app.closeAPKModal()">√ó</button>
            <div class="modal-header">
                <h2>üì± Download S Quiz for Android</h2>
                <p>Get the native Android app</p>
            </div>
            <div class="modal-body">
                <div class="apk-download-section">
                    <i class="bi bi-android2" style="font-size: 4rem; color: #3ddc84; margin-bottom: 15px; display: block;"></i>
                    <h3>Install S Quiz APK</h3>
                    <p>Experience S Quiz as a native Android app with offline support!</p>
                    <a href="/static/app/S-Quiz.apk" download class="download-btn">
                        <i class="bi bi-download"></i>
                        Download APK
                    </a>
                </div>

                <h3><i class="bi bi-list-ol"></i> Installation Instructions</h3>
                <ul style="text-align: left;">
                    <li>Download the APK file above</li>
                    <li>Open your device Settings</li>
                    <li>Go to Security ‚Üí Install Unknown Apps</li>
                    <li>Enable installation for your browser</li>
                    <li>Tap the downloaded APK to install</li>
                    <li>Open S Quiz and start learning!</li>
                </ul>

                <p style="font-size: 0.85rem; color: var(--text-muted); margin-top: 20px;">
                    <i class="bi bi-shield-check"></i> The APK is safe and built from our official GitHub repository.
                </p>
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-secondary" onclick="app.closeAPKModal()">
                    Close
                </button>
            </div>
        </div>
    </div>

    <script>
        // Helper for navigation highlighting
        function setActiveNav(element) {
            document.querySelectorAll('.nav-pill').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }
    </script>
    <script src="/static/translations.js"></script>
    <script src="/static/script.js?v=4"></script>
</body>

</html>